# Mini Query Builder v2.0 - Kullanım Kılavuzu

## v2.0'deki Yenilikler

Bu sürüm SOLID prensiplerini takip eden büyük bir refactoring içeriyor ve birçok yeni özellik sunuyor:

### 🚀 Yeni Özellikler

#### 1. Sınıf Tabanlı Query Builder'lar

Artık daha akıcı API için sınıf tabanlı query builder'ları kullanabilirsiniz:

```typescript
import { queryBuilderFactory } from "mini-query-builder";

// Akıcı API ile SELECT
const result = queryBuilderFactory
  .createSelect(User)
  .where({ status: "active" })
  .orderBy("name", "ASC")
  .limit(10)
  .build();

// Akıcı API ile UPDATE
const updateResult = queryBuilderFactory
  .createUpdate(User)
  .set({ status: "inactive" })
  .where({ id: { $gt: 100 } })
  .build();
```

#### 2. Ortak Transformer'lar

Yaygın veri türleri için önceden oluşturulmuş transformer'lar:

```typescript
import { CommonTransformers } from 'mini-query-builder';

@Column({
  name: 'settings',
  transformer: CommonTransformers.JSON // Objeler ve diziler için
})
settings: UserSettings;

@Column({
  name: 'tags',
  transformer: CommonTransformers.STRING_ARRAY // String dizileri için
})
tags: string[];

@Column({
  name: 'scores',
  transformer: CommonTransformers.NUMBER_ARRAY // Sayı dizileri için
})
scores: number[];
```

#### 3. Gelişmiş Tip Güvenliği

Daha iyi intellisense ile geliştirilmiş TypeScript desteği:

```typescript
// WHERE cümleleri için güçlü tipleme
const query = selectQuery(User, {
  where: {
    age: { $gte: 18 }, // ✅ Geçerli
    name: { $like: "%john%" }, // ✅ Geçerli
    // email: { $like: 123 }   // ❌ TypeScript hatası
  },
});
```

#### 4. Daha İyi Hata Yönetimi

Kapsamlı hata türleri:

```typescript
import {
  MetadataNotFoundError,
  InvalidRelationError,
} from "mini-query-builder";

try {
  const query = selectQuery(UnknownEntity);
} catch (error) {
  if (error instanceof MetadataNotFoundError) {
    console.log("Entity uygun şekilde decorate edilmemiş");
  }
}
```

#### 5. Gelişmiş BaseEntity

Daha fazla yardımcı metot:

```typescript
const user = new User();
user.name = "John";

// Düz objeye dönüştür
const plain = user.toPlain();

// Entity'yi klonla
const clone = user.clone();

// Kaydetmeden önce doğrula
user.validate();
```

### 🏗️ Mimari İyileştirmeler

#### SOLID Prensipleri Uygulandı

- **Tek Sorumluluk**: Her sınıfın tek ve net bir amacı var
- **Açık/Kapalı**: Mevcut kodu değiştirmeden genişletilebilir
- **Liskov Yerine Geçme**: Interface'ler güvenle değiştirilebilir
- **Interface Ayrımı**: Küçük, odaklanmış interface'ler
- **Bağımlılık Tersine Çevirme**: Somut sınıflara değil, soyutlamalara bağımlı

#### Yeni Query Operatörleri

Gelişmiş WHERE cümlesi operatörleri:

```typescript
const queries = selectQuery(User, {
  where: {
    age: { $gte: 18 }, // Büyük veya eşit
    status: { $in: ["active", "pending"] }, // IN cümlesi
    email: { $null: false }, // NOT NULL
    name: { $not: "admin" }, // EŞİT DEĞİL
  },
});
```

### 📚 Geçiş Kılavuzu

#### Mevcut Kullanıcılar İçin

Tüm mevcut kod değişiklik olmadan çalışmaya devam eder:

```typescript
// Bu hala aynı şekilde çalışır
const query = selectQuery(User, {
  where: { id: 1 },
  relations: ["posts"],
});
```

#### Önerilen Güncellemeler

Yeni kod için sınıf tabanlı yaklaşımı tercih edin:

```typescript
// Eski yol (hala destekleniyor)
const oldQuery = selectQuery(User, { where: { id: 1 } });

// Yeni yol (önerilen)
const newQuery = queryBuilderFactory
  .createSelect(User)
  .where({ id: 1 })
  .build();
```

### 🔧 Gelişmiş Kullanım

#### Özel Transformer'lar

Kendi transformer'larınızı oluşturun:

```typescript
const customTransformer: IValueTransformer<MyType, string> = {
  to: (value: MyType) => value.serialize(),
  from: (value: string) => MyType.deserialize(value),
};
```

#### Özel Operatörler

WHERE cümlesi operatörlerini genişletin:

```typescript
import { OperatorRegistry } from "mini-query-builder";

OperatorRegistry.register("$custom", {
  handle: (columnName, operand, transformer) => ({
    condition: `${columnName} CUSTOM ?`,
    params: [transformer(operand)],
  }),
});
```

### 🐛 Hata Düzeltmeleri

- Döngüsel bağımlılık sorunları düzeltildi
- Bellek kullanımı iyileştirildi
- Daha iyi hata mesajları
- Gelişmiş tip çıkarımı

### 🚀 Performans İyileştirmeleri

- Daha hızlı query oluşturma
- Azaltılmış bundle boyutu
- Daha iyi tree shaking desteği
- Optimize edilmiş metadata depolama

## Geriye Uyumluluk

Tüm mevcut API'ler tam işlevselliğini koruyor. Bu, v1.0 koduyla uyumluluğu korurken yeni özellikler ekleyen **değişiklik yapmayan** bir güncellemedir.
